old <- read.nexus("data/flu_HA.nexus")
library(ape)
old <- read.nexus("data/flu_HA.nexus")
old <- read.tree("data/flu_HA.nexus")
new <- read.tree("data/flu_HA.tre")
library(phangorn)
KF.dist(new,old)
new$edge.length[1:10]
old$edge.length[1:10]
plot(sort(new$edge.length),old$edge.length)
plot(sort(new$edge.length),sort(old$edge.length))
abline(a=0,b=1)
1500*0.25/2
1502*0.25/2
1504*0.25/2
1496*0.25/2
1496*0.75
1122 + 2 * 187
sum(new$edge.length)
sum(old$edge.length)
ppois(0,0.6581199)
ppois(1,0.6581199)
dpois(1,0.6581199)
dpois(0,0.6581199)
dpois(2,0.6581199)
sum(dpois(3:100,0.6581199))
sum(c(1:34) * c(2, 1, 2, 2, 6, 6, 5, 5, 6, 9, 19, 13, 14, 12, 19, 24, 21, 16, 24, 17, 29, 21, 12, 16, 5, 11, 3, 7, 6, 1, 3, 3, 2, 3))
sum(c(1:34) * c(2, 1, 2, 2, 6, 6, 5, 5, 6, 9, 19, 13, 14, 12, 19, 24, 21, 16, 24, 17, 29, 21, 12, 16, 5, 11, 3, 7, 6, 1, 3, 3, 2, 3))/345
sum(((c(1:34) * c(2, 1, 2, 2, 6, 6, 5, 5, 6, 9, 19, 13, 14, 12, 19, 24, 21, 16, 24, 17, 29, 21, 12, 16, 5, 11, 3, 7, 6, 1, 3, 3, 2, 3)) - 17.70435)^2)/345
tmp <- c(2, 1, 2, 2, 6, 6, 5, 5, 6, 9, 19, 13, 14, 12, 19, 24, 21, 16, 24, 17, 29, 21, 12, 16, 5, 11, 3, 7, 6, 1, 3, 3, 2, 3)
tmp2 <- sapply(1:34,function(i){rep(i,tmp[i])})
tmp2[1:10]
hist(unlist(tmp))
hist(unlist(tmp2))
var(unlist(tmp2))
curve(dnorm(x,mean((unlist(tmp2)),sd(unlist(tmp2)))),0,35,1001,add=TRUE)
hist(unlist(tmp2),freq=F)
curve(dnorm(x,mean((unlist(tmp2)),sd(unlist(tmp2)))),0,35,1001,add=TRUE)
sd(unlist(tmp2))
m <- mean((unlist(tmp2))
m <- mean((unlist(tmp2)))
s <- sd(unlist(tmp2))
hist(unlist(tmp2),freq=F)
curve(dnorm(x,m,s),0,35,1001,add=T)
